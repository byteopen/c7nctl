name: Build and List Artifacts
on:
  push:
    branches: [ main ]  # 主分支推送时触发
  workflow_dispatch:   # 支持手动触发

jobs:
  build-and-list:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4  # 检出当前仓库代码[1,6](@ref)

      - name: Set up Go
        uses: actions/setup-go@v4  # 配置Go环境[6,7](@ref)
        with:
          go-version: '1.22'       # 指定Go版本

      - name: Install Dependencies
        run: |
          go get -v ./...          # 安装项目依赖[6](@ref)
          echo "✅ Dependencies installed"

      - name: Build Project
        run: |
          go build # 编译并指定输出目录[7](@ref)
          echo "🛠️ Build completed"

      - name: List Compiled Files
        run: |
          echo "📦 Compiled Artifacts:"
          find bin/ -type f -exec ls -lh {} \;  # 递归列出编译产物[1,3](@ref)
          echo "---------------------------------"
          echo "🗂️ Full directory structure:"
          tree bin/ || ls -R bin/               # 展示目录树结构
